@tailwind base;
@tailwind components;
@tailwind utilities;

/* ─────────────────────────────────────────
   Dark Theme — Puebla Bot "Coal & Ivory"
   Tokens y capas visuales
   ───────────────────────────────────────── */
:root {
  /* Base */
  --bg: #0a0a0a; /* coal */
  --bg-2: #0d0d0d;
  --surface-1: #121212; /* card base */
  --surface-2: #161616; /* inputs / tiles */
  --surface-3: #1b1b1b; /* hover / active */

  /* Text */
  --text: #eee6d6; /* warm ivory */
  --text-muted: #bfb6a3;
  --placeholder: #8b8578;

  /* Accents */
  --brand: #e3c07a; /* camel */
  --brand-strong: #f1d89a;
  --good: #86efac;
  --warn: #fde68a;

  /* Borde y sombras */
  --border: #272727;
  --border-soft: #2f2f2f;
  --tile-dashed: #3a3a3a;

  /* Botones */
  --btn-bg: #161616;
  --btn-text: var(--text);
  --btn-border: #363636;

  /* Focus ring accesible */
  --ring: #f6e3b4;
  --ring-offset: #0c0c0c;

  /* Elevaciones */
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.35);
  --shadow-md: 0 6px 18px rgba(0, 0, 0, 0.45);
  --shadow-lg: 0 14px 40px rgba(0, 0, 0, 0.5);
}

/* Fondo con leve gradiente + grano para dar vida sin ruido */
body {
  margin: 0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu,
    "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
  color: var(--text);
  background: radial-gradient(
      1200px 800px at 10% -10%,
      rgba(227, 192, 122, 0.08),
      transparent 60%
    ),
    radial-gradient(
      1000px 700px at 110% 10%,
      rgba(156, 163, 175, 0.06),
      transparent 65%
    ),
    linear-gradient(180deg, var(--bg), var(--bg-2));
}

/* Sutil patrón de grano (opcional). Comenta si no te gusta. */
body::before {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='140' height='140' viewBox='0 0 140 140'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='2' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3CfeComponentTransfer%3E%3CfeFuncA type='table' tableValues='0 0 .015 .03'/%3E%3C/feComponentTransfer%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  opacity: 0.35;
}

/* Contenedores principales */
.app-header,
.app-footer {
  position: sticky;
  top: 0;
  z-index: 10;
  display: flex;
  align-items: center;
  gap: 0.6rem;
  padding: 0.8rem 1rem;
  color: var(--text);
  background: rgba(10, 10, 10, 0.8);
  backdrop-filter: saturate(160%) blur(8px);
  border-bottom: 1px solid var(--border);
}
.app-footer {
  top: auto;
  bottom: 0;
  justify-content: center;
  background: rgba(12, 12, 12, 0.85);
  border-top: 1px solid var(--border);
  border-bottom: none;
  color: var(--text-muted);
}

.title {
  font-weight: 800;
  letter-spacing: 0.2px;
}

.container {
  max-width: 980px;
  margin: 1rem auto;
  padding: 0 1rem 4rem;
  display: grid;
  gap: 1rem;
}

/* Tarjetas/elevación */
.card {
  background: linear-gradient(180deg, var(--surface-1), var(--surface-2));
  border: 1px solid var(--border);
  border-radius: 18px;
  padding: 1rem;
  box-shadow: var(--shadow-sm);
  transition: box-shadow 0.25s ease, border-color 0.25s ease,
    transform 0.05s ease;
}
.card:hover {
  box-shadow: var(--shadow-md);
  border-color: var(--border-soft);
}
.card:active {
  transform: translateY(1px);
}

/* Segmentado modo Taller/Pueblo */
.mode-switch {
  display: inline-flex;
  padding: 4px;
  background: var(--surface-2);
  border: 1px solid var(--border);
  border-radius: 12px;
  gap: 6px;
}
.mode-switch button {
  appearance: none;
  border: 0;
  background: transparent;
  color: var(--text-muted);
  padding: 0.45rem 0.8rem;
  border-radius: 8px;
  font-weight: 600;
  transition: background 0.2s ease, color 0.2s ease;
}
.mode-switch button:hover {
  color: var(--text);
  background: #1c1c1c;
}
.mode-switch button.active {
  color: #0b0b0b;
  background: linear-gradient(180deg, var(--brand-strong), var(--brand));
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.25),
    0 1px 6px rgba(227, 192, 122, 0.2);
}

/* Grid de acciones/retos */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(210px, 1fr));
  gap: 0.75rem;
}
.tile {
  background: var(--surface-2);
  border: 1px dashed var(--tile-dashed);
  border-radius: 14px;
  padding: 0.9rem;
  color: var(--text);
  cursor: pointer;
  transition: border-color 0.2s ease, transform 0.05s ease,
    box-shadow 0.25s ease, background 0.2s ease;
  box-shadow: 0 0 0 rgba(0, 0, 0, 0);
}
.tile:hover {
  border-style: solid;
  border-color: var(--brand);
  box-shadow: 0 6px 20px rgba(227, 192, 122, 0.12);
  background: #1a1a1a;
}
.tile:active {
  transform: translateY(1px);
}

/* Formularios */
.form label {
  display: block;
  margin: 0.5rem 0 0.3rem;
  color: var(--text-muted);
  font-weight: 600;
}
textarea,
input {
  width: 100%;
  padding: 0.7rem 0.8rem;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: var(--surface-2);
  color: var(--text);
  outline: none;
  transition: border-color 0.15s ease, box-shadow 0.15s ease,
    background 0.15s ease;
}
textarea::placeholder,
input::placeholder {
  color: var(--placeholder);
}
textarea:focus,
input:focus {
  border-color: var(--brand-strong);
  box-shadow: 0 0 0 2px var(--ring-offset),
    0 0 0 4px color-mix(in srgb, var(--ring) 60%, transparent);
}

/* Botones */
button {
  cursor: pointer;
  border-radius: 12px;
  padding: 0.6rem 1rem;
  border: 1px solid var(--btn-border);
  background: var(--btn-bg);
  color: var(--btn-text);
  font-weight: 700;
  transition: transform 0.05s ease, background 0.2s ease, border-color 0.2s ease,
    box-shadow 0.2s ease;
}
button:hover {
  background: #1d1d1d;
  border-color: #444;
}
button:active {
  transform: translateY(1px);
}
button:focus-visible {
  outline: none;
  box-shadow: 0 0 0 2px var(--ring-offset),
    0 0 0 4px color-mix(in srgb, var(--ring) 60%, transparent);
}

/* Botón primario (úsalo en “Buscar actualizaciones”, etc.) */
button.primary {
  background: linear-gradient(180deg, var(--brand-strong), var(--brand));
  color: #0b0b0b;
  border-color: #a07c2e;
  box-shadow: 0 8px 20px rgba(227, 192, 122, 0.25);
}
button.primary:hover {
  filter: brightness(1.05);
}
button.primary:active {
  filter: brightness(0.98);
}

/* Outlined */
button.outline {
  background: transparent;
  color: var(--text);
  border-color: var(--border);
}

/* Badges/estado */
.status {
  display: flex;
  gap: 0.5rem;
  align-items: center;
  flex-wrap: wrap;
}
.badge {
  background: #3b2b00;
  color: var(--warn);
  border: 1px solid #5b4510;
  border-radius: 999px;
  padding: 0.22rem 0.55rem;
  font-weight: 700;
  letter-spacing: 0.2px;
}

/* Chat */
.chat {
  display: flex;
  flex-direction: column;
  height: 380px;
  border: 1px solid var(--border);
  border-radius: 14px;
  background: var(--surface-2);
  overflow: hidden;
  box-shadow: var(--shadow-sm);
}
.messages {
  flex: 1;
  overflow: auto;
  padding: 1rem;
  background: #0f0f0f;
}
.message {
  margin: 0.35rem 0;
  padding: 0.6rem 0.8rem;
  border-radius: 12px;
  max-width: 80%;
  line-height: 1.4;
  box-shadow: 0 1px 0 rgba(0, 0, 0, 0.25);
}
.user {
  margin-left: auto;
  background: #1f2937;
  color: var(--text);
}
.bot {
  background: #161616;
  color: var(--text);
  border: 1px solid #242424;
}
.composer {
  display: flex;
  gap: 0.5rem;
  padding: 0.5rem;
  border-top: 1px solid var(--border);
  background: var(--surface-2);
}

/* Tarjetas de “contenido local” */
.kb {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 0.6rem;
}
.kb .item {
  background: #151515;
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 0.7rem 0.8rem;
  box-shadow: var(--shadow-sm);
}

/* Links */
a {
  color: var(--brand-strong);
  text-underline-offset: 2px;
}
a:hover {
  color: var(--brand);
}

/* Utilidades */
.hidden {
  display: none;
}
button.small {
  padding: 0.35rem 0.6rem;
  font-size: 0.92rem;
}

/* Scrollbar (WebKit) */
*::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}
*::-webkit-scrollbar-track {
  background: #0d0d0d;
}
*::-webkit-scrollbar-thumb {
  background: #2a2a2a;
  border-radius: 10px;
  border: 2px solid #0d0d0d;
}
*::-webkit-scrollbar-thumb:hover {
  background: #3a3a3a;
}

/* Respeto a quien prefiere menos movimiento */
@media (prefers-reduced-motion: reduce) {
  * {
    transition: none !important;
  }
}
/* Utilidad de borde reforzado para pastillas/marcos */
.border-thick {
  border-width: 2px !important;
}
/* ─────────────────────────────────────────
   VARIANTE 1 · Coal Glass
   Activa con: <body class="theme-glass">
   ───────────────────────────────────────── */
body.theme-glass .app-header,
body.theme-glass .app-footer {
  background: rgba(10, 10, 10, 0.55);
  backdrop-filter: saturate(170%) blur(10px);
}

body.theme-glass .card {
  background: rgba(22, 22, 22, 0.55);
  border-color: #3a3a3a;
  backdrop-filter: saturate(140%) blur(10px);
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.45);
}

body.theme-glass .tile {
  background: rgba(20, 20, 20, 0.45);
  backdrop-filter: blur(6px);
  border-color: #454545;
}
body.theme-glass .tile:hover {
  background: rgba(26, 26, 26, 0.55);
  box-shadow: 0 10px 26px rgba(227, 192, 122, 0.14);
}

body.theme-glass .chat {
  background: rgba(18, 18, 18, 0.55);
  backdrop-filter: blur(8px);
}

/* ─────────────────────────────────────────
   VARIANTE 2 · Alto contraste
   Activa con: <body class="contrast-high">
   Puedes combinarla con .theme-glass
   ───────────────────────────────────────── */
body.contrast-high {
  /* Subimos contraste y legibilidad */
  --bg: #000000;
  --bg-2: #000000;
  --surface-1: #0f0f0f;
  --surface-2: #111111;
  --surface-3: #151515;

  --text: #fffdf7;
  --text-muted: #f0e7cf;
  --placeholder: #d2c8b4;

  --brand: #ffd164;
  --brand-strong: #ffe08a;

  --border: #5a5a5a;
  --border-soft: #6a6a6a;
  --tile-dashed: #6a6a6a;

  --ring: #ffe08a;
  --ring-offset: #000;
}

body.contrast-high .card,
body.contrast-high .chat,
body.contrast-high .kb .item,
body.contrast-high .tile,
body.contrast-high textarea,
body.contrast-high input,
body.contrast-high button {
  border-width: 2px;
}

body.contrast-high a {
  color: var(--brand-strong);
  text-decoration: underline;
  text-underline-offset: 3px;
}

body.contrast-high .mode-switch {
  border-width: 2px;
}
body.contrast-high .mode-switch button.active {
  box-shadow: none; /* evita depender de sombras */
}

body.contrast-high textarea:focus,
body.contrast-high input:focus,
body.contrast-high button:focus-visible {
  box-shadow: 0 0 0 3px var(--ring-offset),
    0 0 0 6px color-mix(in srgb, var(--ring) 80%, transparent);
}

/* Un poco más de tamaño para lectura (opcional): */
body.contrast-high {
  font-size: 17px;
}

/* Si el SO pide más contraste, lo respetamos automáticamente
   (sin interferir si ya pones/quitas la clase manualmente). */
@media (prefers-contrast: more) {
  /* Apply styles directly to body instead of using empty ruleset */
  body:not(.force-contrast-off) {
    /* mismas variables que arriba para asegurar contraste */
    --bg: #000000;
    --bg-2: #000000;
    --surface-1: #0f0f0f;
    --surface-2: #111111;
    --surface-3: #151515;
    --text: #fffdf7;
    --text-muted: #f0e7cf;
    --placeholder: #d2c8b4;
    --brand: #ffd164;
    --brand-strong: #ffe08a;
    --border: #5a5a5a;
    --border-soft: #6a6a6a;
    --tile-dashed: #6a6a6a;
    --ring: #ffe08a;
    --ring-offset: #000;
  }
}
